@using Microsoft.AspNetCore.Mvc.Localization;
@using Microsoft.Extensions.Localization
@inject IViewLocalizer Localizer;
@model IEnumerable<PrintSoftWeb.Models.CreditRatingModel>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Prime Reference Rate";
}
<head>
    <script src="~/jsfiles/commonjs/commonjs.js"></script>
        <link href="~/css/main.css" rel="stylesheet" />
        <style type="text/css">
            .table100 {
                border: 0px !important;
            }
        </style>
</head>
<div class="card shadow mb-4">
    <div class="card-header py-3">
        <div class="row">
            <div class="col-lg-6">
                <h4 class="m-0 font-weight-bold text-primary">@Localizer["Prime Reference Rate"]</h4>
            </div>

        </div>
    </div>
    <div class="card-body">
        <div class="row ">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-lg-4">
                        <label for="name" class="form-label float-lg-end">@Localizer["Date"]:<span class="text-danger">*</span></label>
                    </div>
                    <div class="col-lg-8">
                        <input type="date" class="form-control" id="pr_date" name="name">
                        <input type="text" class="form-control d-none" id="pr_id" name="name">
                    </div>
                </div>
            </div>
            <div class="col-lg-2">
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-lg-4">
                        <label for="name" class="form-label float-lg-end">@Localizer["Rate"]:<span class="text-danger">*</span></label>
                    </div>
                    <div class="col-lg-8">
                        <input type="text" class="form-control" maxlength="100" id="pr_rate" onkeydown="return DecimalNumber(event)" placeholder="@Localizer["Enter Rate"]" name="name">
                    </div>
                </div>
            </div>
            <div class="col-lg-2">
            </div>
        </div>
       @*  <div class="row mt-4">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-lg-4">
                        <label for="name" class="form-label float-lg-end">@Localizer["Value"]:<span class="text-danger">*</span></label>
                    </div>
                    <div class="col-lg-8">
                        <input type="text" maxlength="100" class="form-control" id="pr_value" placeholder="@Localizer["Enter Value"]" name="name">
                    </div>
                </div>
            </div>
            <div class="col-lg-2">
            </div>
        </div> *@
       
    </div>
    <div class="card-footer">
        <div class="row">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-lg-4">
                    </div>
                    <div class="col-lg-8">
                        <button class="btn btn-success" onclick="submitrating()" type="button">@Localizer["Save"]</button>
                        <button class="btn btn-secondary ml-2" onclick="clearrating()" type="button">@Localizer["Clear"]</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-2">
            </div>
        </div>

    </div>
</div>
<div class="card shadow mb-4">
    <!--Start Header -->
    <div class="card-header py-3">
        <div class="row align-items-center justify-content-end">
            <div class="col-auto d-flex flex-wrap toggle">
                <div class="justify-content-lg-end justify-content-md-end justify-content-center mt-lg-0 mt-md-0 mt-3">
                    <input type="text" id="custom-search" class="form-control" placeholder=@Localizer["Search"] />
                </div>

            </div>
        </div>
    </div>
    <div class="card-body">

          <div class="table100 ver2 m-b-110">

            <table class="table table-bordered" id="dataTable1" width="100%" cellspacing="0" data-vertable="ver2">
                <thead>
                    <tr class="row100 head">
                        <th width="10px"> Sr.No </th>
                        <th class="d-none">  </th>
                        <th> Date </th>
                        <th> Rate </th>
                        <th> Action </th>
                       
                    </tr>
                </thead>
                <tbody>

                    @{


                        int no = 1;
                    }
                    @foreach (var item in Model)
                    {

                        <tr class="align-items-center row100">
                            <td>
                                @no
                            </td>
                            <td class="d-none"></td>
                            <td>@String.Format("{0:dd/MM/yyyy}", item.pr_date)</td>
                            <td> @Html.DisplayFor(modelItem => item.pr_rate)</td>
                            <td>
                                <div class="d-inline-flex">
                                    <a class='editicon text-primary' title="Edit" onclick="editLinkClick('@item.pr_id','@item.pr_date','@item.pr_rate')"> <span class='fas fa-edit'></span></a>
                                    <a href="@Url.Action("Delete", new { pr_id = @item.pr_id })" onclick="return confirm('Are you sure you want to delete?')" class='deleteicon text-danger' title="Delete"> <span class='fa fa-trash ml-2'></span></a>
                                </div>
                            </td>
                        </tr>
                        no++;

                    }
                </tbody>
            </table>
        </div>
        <!-- start Pagination-->
        <div class="row mt-3">
            <div class="col-lg-5 col-md-5 col-12 ">
                <div class="row ">
                    <div class="col-lg-3 col-md-3 col-12 d-flex justify-content-lg-start justify-content-md-start justify-content-center ">
                        <h6 class="mt-2">@Localizer["Show"]</h6>&nbsp;&nbsp;
                        <select name="table_id_length" id="table_length_select" aria-controls="table_id" class="form-select w-auto">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                        &nbsp;&nbsp;
                        <h6 class="mt-2">@Localizer["entries"]</h6>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 col-md-2"></div>
            <div class="col-lg-5 col-md-5 col-12 mt-lg-0 mt-md-0 mt-3">
                <nav aria-label="Page navigation example">
                    <div id="table_id_length">

                        <div id="custom-pagination" class=" d-flex text-center text-lg-end justify-content-end  text-end float-end">
                            <ul class="pagination justify-content-lg-end justify-content-md-end justify-content-center">
                                <li class="page-item disabled">
                                    <button class="page-link" href="#" aria-label="Previous" data-page="0"> <span aria-hidden="true">&laquo;</span></button>
                                </li>
                                <li class="page-item active"><button class="page-link" href="#" data-page="1">1</button></li>

                                <li class="page-item "><button class="page-link" href="#" data-page="2" aria-label="Next">  <span aria-hidden="true">&raquo;</span></button></li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</div>
<script>
    function editLinkClick(pr_id, pr_date, pr_rate) {


        //$("#createModal").modal("show");
        $("#pr_id").val(pr_id);
        $("#pr_rate").val(pr_rate);
        var dateParts = pr_date.split(' ')[0].split('/');
        var year = dateParts[2];
        var month = ('0' + dateParts[0]).slice(-2); // Add leading zero if necessary
        var day = ('0' + dateParts[1]).slice(-2); // Add leading zero if necessary
        var formatted_date = year + '-' + month + '-' + day;
        $("#pr_date").val(formatted_date);
    }

    function clearrating() {
        $("#pr_rate").val("");
        $("#pr_date").val("");
        $("#pr_id").val("");
    }
    function submitrating() {
        if ($("#pr_rate").val() == "") {
            alert("Please Enter Rate!");
            return false;
        }else if ($("#pr_date").val() == "") {
            alert("Please Select date!");
            return false;
        } 
        var data = {
            pr_rate: $("#pr_rate").val(),
            pr_value: $("#pr_rate").val(),
            pr_date: $("#pr_date").val(),
            pr_id: $("#pr_id").val(),
        };
        $.ajax({
            type: 'POST',
            url: "PrimeRRate/Create", // Use the form's action attribute
            data: data, // Serialize the form data
            success: function (response) {
                window.location.reload();
            },
            error: function (xhr, status, error) {
                window.location.reload();
            }
        });
    }
    myFunction();
    $('#table_length_select').change();
</script>

